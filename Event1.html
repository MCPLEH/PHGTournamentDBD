<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Å–µ—Ç–∫–∞ - –ú—É–ª—å—Ç–∏—Ä–µ–∂–∏–º</title>
    <link rel="icon" href="https://i.postimg.cc/LsmyN2Ty/target1v1.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }

        body {
            background-color: #000;
            background-image: url('https://framerusercontent.com/images/mnSJcLrRsxC3x00UuNuqZAtE.gif');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #ffcc00;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            color: #ffcc00;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            color: #cccccc;
        }

        .mode-selector {
            background: rgba(255, 204, 0, 0.1);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid #ffcc00;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.3);
        }

        .mode-selector h3 {
            color: #ffcc00;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5em;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .mode-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .mode-btn {
            padding: 15px 30px;
            border: 2px solid #ffcc00;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            background: transparent;
            color: #ffcc00;
            flex: 1;
            min-width: 200px;
            max-width: 300px;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .mode-btn:hover {
            background-color: #ffcc00;
            color: #000;
            box-shadow: 0 0 20px #ffcc00;
            transform: translateY(-3px);
        }

        .mode-btn.active {
            background: #ffcc00;
            color: #000;
            box-shadow: 0 0 15px #ffcc00;
        }

        .mode-description {
            margin-top: 10px;
            font-size: 0.9em;
            color: #cccccc;
            text-align: center;
        }

        .config-panel {
            background: rgba(255, 204, 0, 0.1);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid #ffcc00;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.3);
            display: none;
        }

        .config-panel h3 {
            color: #ffcc00;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5em;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .config-item {
            margin-bottom: 20px;
        }

        .config-item label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #ffcc00;
            display: block;
        }

        .config-item textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #ffcc00;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            font-family: inherit;
            height: 120px;
            resize: vertical;
            background: #000;
            color: #ffcc00;
        }

        .config-item textarea:focus {
            outline: none;
            box-shadow: 0 0 10px #ffcc00;
        }

        .config-item input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ffcc00;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            font-family: inherit;
            background: #000;
            color: #ffcc00;
        }

        .config-item input:focus {
            outline: none;
            box-shadow: 0 0 10px #ffcc00;
        }

        .config-item .hint {
            color: #cccccc;
            font-size: 14px;
            margin-top: 5px;
        }

        .config-item select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ffcc00;
            border-radius: 10px;
            font-size: 16px;
            background: #000;
            color: #ffcc00;
            cursor: pointer;
        }

        .config-item select:focus {
            outline: none;
            box-shadow: 0 0 10px #ffcc00;
        }

        .players-preview {
            margin-top: 15px;
        }

        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .player-tag {
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
            padding: 10px 15px;
            border-radius: 25px;
            text-align: center;
            font-weight: 500;
            border: 1px solid #ffcc00;
        }

        .player-tag.boss {
            background: rgba(255, 0, 0, 0.2);
            border-color: #ff3333;
            color: #ff3333;
            font-weight: bold;
        }

        .status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
            border: 1px solid;
        }

        .status.success {
            background: rgba(0, 255, 0, 0.1);
            color: #00ff00;
            border-color: #00ff00;
        }

        .status.error {
            background: rgba(255, 0, 0, 0.1);
            color: #ff3333;
            border-color: #ff3333;
        }

        .tournament-grid {
            display: flex;
            gap: 30px;
            overflow-x: auto;
            padding: 30px;
            background: rgba(255, 204, 0, 0.1);
            border-radius: 15px;
            border: 2px solid #ffcc00;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.3);
            margin-bottom: 30px;
            min-height: 500px;
        }

        .round {
            min-width: 300px;
        }

        .round-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
            border-radius: 10px;
            font-size: 1.3em;
            border: 1px solid #ffcc00;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .match {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #ffcc00;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .match::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: #ffcc00;
        }

        .match:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 204, 0, 0.4);
            border-color: #ffcc00;
        }

        .player {
            padding: 12px 15px;
            margin: 8px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            background: rgba(255, 204, 0, 0.1);
            color: #ffcc00;
        }

        .player.boss-player {
            background: rgba(255, 0, 0, 0.2);
            color: #ff3333;
            font-weight: bold;
            border-color: #ff3333;
        }

        .player::before {
            content: '‚öîÔ∏è';
            margin-right: 10px;
            font-size: 1.1em;
        }

        .player.boss-player::before {
            content: 'üëë';
        }

        .player:hover {
            background-color: rgba(255, 204, 0, 0.2);
            border-color: #ffcc00;
            transform: scale(1.02);
        }

        .player.winner {
            background: rgba(0, 255, 0, 0.2);
            color: #00ff00;
            font-weight: bold;
            border-color: #00ff00;
        }

        .player.winner::before {
            content: 'üèÜ';
        }

        .player.loser {
            background: rgba(255, 0, 0, 0.2);
            color: #ff3333;
            opacity: 0.7;
            border-color: #ff3333;
        }

        .player.loser::before {
            content: 'üíÄ';
        }

        .player.absent {
            background: rgba(128, 128, 128, 0.2);
            color: #cccccc;
            opacity: 0.6;
            border-color: #cccccc;
        }

        .player.absent::before {
            content: '‚è∏Ô∏è';
        }

        .player.bye {
            background: rgba(255, 165, 0, 0.2);
            color: #ffa500;
            border-color: #ffa500;
        }

        .player.bye::before {
            content: '‚≠ê';
        }

        .player-score {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }

        .player-time {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: bold;
            font-family: monospace;
        }

        .player-actions {
            display: flex;
            gap: 5px;
            margin-top: 5px;
        }

        .action-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
            flex: 1;
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
            border: 1px solid #ffcc00;
        }

        .action-btn.absent {
            background: rgba(128, 128, 128, 0.2);
            color: #cccccc;
            border-color: #cccccc;
        }

        .action-btn.present {
            background: rgba(0, 255, 0, 0.2);
            color: #00ff00;
            border-color: #00ff00;
        }

        .action-btn.undo {
            background: rgba(255, 165, 0, 0.2);
            color: #ffa500;
            border-color: #ffa500;
        }

        .action-btn.timer {
            background: rgba(0, 191, 255, 0.2);
            color: #00bfff;
            border-color: #00bfff;
        }

        .action-btn:hover {
            opacity: 0.9;
            transform: scale(1.05);
            box-shadow: 0 0 8px currentColor;
        }

        .timer-input-container {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        .timer-input {
            flex: 1;
            padding: 8px;
            border: 1px solid #ffcc00;
            border-radius: 5px;
            background: #000;
            color: #ffcc00;
            font-family: monospace;
            text-align: center;
        }

        .timer-input:focus {
            outline: none;
            box-shadow: 0 0 5px #ffcc00;
        }

        .timer-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: rgba(0, 191, 255, 0.2);
            color: #00bfff;
            font-weight: bold;
            border: 1px solid #00bfff;
        }

        .controls {
            text-align: center;
            margin: 30px 0;
        }

        .btn {
            padding: 15px 30px;
            margin: 0 10px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            background: transparent;
            color: #ffcc00;
            border: 2px solid #ffcc00;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: transparent;
            color: #ffcc00;
            border-color: #ffcc00;
        }

        .btn-success {
            background: transparent;
            color: #00ff00;
            border-color: #00ff00;
        }

        .btn-danger {
            background: transparent;
            color: #ff3333;
            border-color: #ff3333;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 204, 0, 0.4);
            background-color: #ffcc00;
            color: #000;
        }

        .btn-success:hover {
            background-color: #00ff00;
            color: #000;
        }

        .btn-danger:hover {
            background-color: #ff3333;
            color: #000;
        }

        .btn:disabled {
            background: #555;
            transform: none;
            box-shadow: none;
            cursor: not-allowed;
            color: #888;
            border-color: #888;
        }

        .btn:disabled:hover {
            background: #555;
            color: #888;
        }

        .champion {
            text-align: center;
            padding: 40px;
            background: rgba(255, 215, 0, 0.2);
            border-radius: 20px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
            animation: pulse 2s infinite;
            border: 2px solid #ffcc00;
        }

        .champion h2 {
            font-size: 2.5em;
            color: #ffcc00;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .champion .winner-name {
            font-size: 3em;
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin: 20px 0;
        }

        .champion-stats {
            font-size: 1.2em;
            color: #ffcc00;
            margin: 10px 0;
        }

        .standings {
            background: rgba(255, 204, 0, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #ffcc00;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.3);
            display: none;
        }

        .standings h3 {
            color: #ffcc00;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5em;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .standings-table {
            width: 100%;
            border-collapse: collapse;
        }

        .standings-table th,
        .standings-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ffcc00;
            color: #ffcc00;
        }

        .standings-table th {
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
            font-weight: 600;
            text-transform: uppercase;
        }

        .standings-table tr:hover {
            background-color: rgba(255, 204, 0, 0.05);
        }

        .standings-table .position-1 {
            background: rgba(255, 215, 0, 0.3);
            color: #ffcc00;
            font-weight: bold;
        }

        .standings-table .position-2 {
            background: rgba(192, 192, 192, 0.3);
            color: #cccccc;
            font-weight: bold;
        }

        .standings-table .position-3 {
            background: rgba(205, 127, 50, 0.3);
            color: #cd7f32;
            font-weight: bold;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .vs {
            text-align: center;
            color: #ffcc00;
            font-weight: bold;
            margin: 5px 0;
            font-size: 0.9em;
            text-transform: uppercase;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .tournament-grid {
                flex-direction: column;
                gap: 20px;
            }
            
            .round {
                min-width: 100%;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .btn {
                padding: 12px 20px;
                margin: 5px;
                width: 90%;
            }
            
            .standings-table {
                font-size: 14px;
            }
            
            .standings-table th,
            .standings-table td {
                padding: 8px 10px;
            }

            .mode-buttons {
                flex-direction: column;
                align-items: center;
            }

            .mode-btn {
                width: 100%;
                max-width: 100%;
            }
        }

        /* –°–∫—Ä—ã—Ç–∞—è –∫–Ω–æ–ø–∫–∞ –≤ –ª–µ–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É */
        .hidden-button {
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            position: fixed;
            bottom: 10px;
            left: 10px;
            cursor: pointer;
            z-index: 1000;
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
            border: 1px solid #ffcc00;
        }
        
        .hidden-button:hover {
            background-color: #ffcc00;
            color: #000;
        }

        /* Cyber Punk —ç—Ñ—Ñ–µ–∫—Ç—ã */
        .cyber-line {
            height: 2px;
            background: linear-gradient(90deg, transparent, #ffcc00, transparent);
            margin: 20px 0;
        }

        .glitch-text {
            position: relative;
            display: inline-block;
        }

        .glitch-text::before,
        .glitch-text::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .glitch-text::before {
            left: 2px;
            text-shadow: -2px 0 #ff00ff;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim 5s infinite linear alternate-reverse;
        }

        .glitch-text::after {
            left: -2px;
            text-shadow: -2px 0 #00ffff;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim2 5s infinite linear alternate-reverse;
        }

        @keyframes glitch-anim {
            0% { clip: rect(42px, 9999px, 44px, 0); }
            5% { clip: rect(12px, 9999px, 59px, 0); }
            10% { clip: rect(48px, 9999px, 29px, 0); }
            15% { clip: rect(42px, 9999px, 73px, 0); }
            20% { clip: rect(63px, 9999px, 27px, 0); }
            25% { clip: rect(34px, 9999px, 55px, 0); }
            30% { clip: rect(86px, 9999px, 73px, 0); }
            35% { clip: rect(20px, 9999px, 20px, 0); }
            40% { clip: rect(26px, 9999px, 60px, 0); }
            45% { clip: rect(25px, 9999px, 66px, 0); }
            50% { clip: rect(57px, 9999px, 98px, 0); }
            55% { clip: rect(5px, 9999px, 46px, 0); }
            60% { clip: rect(82px, 9999px, 31px, 0); }
            65% { clip: rect(54px, 9999px, 27px, 0); }
            70% { clip: rect(28px, 9999px, 99px, 0); }
            75% { clip: rect(45px, 9999px, 69px, 0); }
            80% { clip: rect(23px, 9999px, 85px, 0); }
            85% { clip: rect(54px, 9999px, 84px, 0); }
            90% { clip: rect(45px, 9999px, 47px, 0); }
            95% { clip: rect(37px, 9999px, 20px, 0); }
            100% { clip: rect(4px, 9999px, 91px, 0); }
        }

        @keyframes glitch-anim2 {
            0% { clip: rect(65px, 9999px, 100px, 0); }
            5% { clip: rect(52px, 9999px, 74px, 0); }
            10% { clip: rect(79px, 9999px, 85px, 0); }
            15% { clip: rect(75px, 9999px, 5px, 0); }
            20% { clip: rect(67px, 9999px, 61px, 0); }
            25% { clip: rect(14px, 9999px, 79px, 0); }
            30% { clip: rect(1px, 9999px, 66px, 0); }
            35% { clip: rect(86px, 9999px, 30px, 0); }
            40% { clip: rect(23px, 9999px, 98px, 0); }
            45% { clip: rect(85px, 9999px, 72px, 0); }
            50% { clip: rect(71px, 9999px, 75px, 0); }
            55% { clip: rect(2px, 9999px, 48px, 0); }
            60% { clip: rect(30px, 9999px, 16px, 0); }
            65% { clip: rect(59px, 9999px, 50px, 0); }
            70% { clip: rect(41px, 9999px, 62px, 0); }
            75% { clip: rect(2px, 9999px, 82px, 0); }
            80% { clip: rect(47px, 9999px, 73px, 0); }
            85% { clip: rect(3px, 9999px, 27px, 0); }
            90% { clip: rect(26px, 9999px, 55px, 0); }
            95% { clip: rect(42px, 9999px, 97px, 0); }
            100% { clip: rect(38px, 9999px, 49px, 0); }
        }
    </style>
</head>
<body>
    <!-- –°–∫—Ä—ã—Ç–∞—è –∫–Ω–æ–ø–∫–∞ –≤ –ª–µ–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É -->
    <button class="hidden-button" onclick="window.location.href='index.html'" title="–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é">
        <i class="fas fa-home"></i>
    </button>

    <div class="container">
        <div class="header">
            <h1 class="glitch-text" data-text="‚öîÔ∏è –ü–æ–µ–¥–∏–Ω–∫–∏ 1v1 ‚öîÔ∏è">‚öîÔ∏è –ü–æ–µ–¥–∏–Ω–∫–∏ 1v1 ‚öîÔ∏è</h1>
            <p>–î–∞ –Ω–∞—á–Ω—ë—Ç—Å—è –±–∏—Ç–≤–∞!</p>
        </div>

        <div class="mode-selector" id="modeSelector">
            <h3>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ç—É—Ä–Ω–∏—Ä–∞</h3>
            <div class="mode-buttons">
                <button class="mode-btn" onclick="selectMode('classic')" id="classicMode">
                    1v1 –ö–ª–∞—Å—Å–∏–∫–∞
                    <div class="mode-description">–û–¥–∏–Ω–æ—á–Ω—ã–µ –º–∞—Ç—á–∏ –ø–æ –≤—ã–±–æ—Ä—É</div>
                </button>
                <button class="mode-btn" onclick="selectMode('bracket')" id="bracketMode">
                    –¢—É—Ä–Ω–∏—Ä –ø–æ –°–µ—Ç–∫–µ
                    <div class="mode-description">–û–ª–∏–º–ø–∏–π—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –≤—ã–±—ã–≤–∞–Ω–∏–µ–º</div>
                </button>
                <button class="mode-btn" onclick="selectMode('king')" id="kingMode">
                    –¶–∞—Ä—å –ì–æ—Ä—ã
                    <div class="mode-description">–ö–∞–∂–¥—ã–π —Å—Ä–∞–∂–∞–µ—Ç—Å—è —Å –∫–∞–∂–¥—ã–º</div>
                </button>
                <button class="mode-btn" onclick="selectMode('timer')" id="timerMode">
                    1v1 –¢–∞–π–º–µ—Ä
                    <div class="mode-description">–°–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞ –ª—É—á—à–µ–µ –≤—Ä–µ–º—è</div>
                </button>
                <button class="mode-btn" onclick="selectMode('boss')" id="bossMode">
                    –í—Å–µ –ø—Ä–æ—Ç–∏–≤ –ë–æ—Å—Å–∞
                    <div class="mode-description">–ö–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –ø—Ä–æ—Ç–∏–≤ –æ–¥–Ω–æ–≥–æ –±–æ—Å—Å–∞</div>
                </button>
            </div>
        </div>

        <div class="config-panel" id="configPanel">
            <h3>–î–æ–±–∞–≤—å—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Ç—É—Ä–Ω–∏—Ä–∞</h3>
            
            <div class="config-item">
                <label for="playersInput">–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º—ã –∏–≥—Ä–æ–∫–æ–≤ (–∫–∞–∂–¥—ã–π —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏):</label>
                <textarea id="playersInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä:
–ò–≥—Ä–æ–∫1
–ò–≥—Ä–æ–∫2
–ò–≥—Ä–æ–∫3
–í–æ–∏–Ω_–°–≤–µ—Ç–∞
–¢–µ–º–Ω—ã–π_–†—ã—Ü–∞—Ä—å"></textarea>
                <div class="hint" id="playersHint">–ú–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞</div>
            </div>

            <!-- –ü–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –Ω–∏–∫–∞ –±–æ—Å—Å–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ "–í—Å–µ –ø—Ä–æ—Ç–∏–≤ –ë–æ—Å—Å–∞" -->
            <div class="config-item" id="bossInputContainer" style="display: none;">
                <label for="bossInput">–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫ –ë–æ—Å—Å–∞:</label>
                <input type="text" id="bossInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ì–ª–∞–≤–Ω—ã–π_–ë–æ—Å—Å">
                <div class="hint">–ë–æ—Å—Å –±—É–¥–µ—Ç —Å—Ä–∞–∂–∞—Ç—å—Å—è –ø—Ä–æ—Ç–∏–≤ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</div>
            </div>

            <div class="players-preview" id="playersPreview" style="display: none;">
                <label>–ë—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∏–≥—Ä–æ–∫–∏:</label>
                <div class="players-grid" id="playersList">
                    <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>

            <div class="status" id="statusMessage"></div>

            <div class="controls">
                <button class="btn btn-primary" onclick="validateAndStart()">–ù–∞—á–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä</button>
            </div>
        </div>

        <div class="standings" id="standingsSection">
            <h3>üèÜ –¢–ê–ë–õ–ò–¶–ê –õ–ò–î–ï–†–û–í</h3>
            <table class="standings-table" id="standingsTable">
                <thead>
                    <tr>
                        <th>–ú–µ—Å—Ç–æ</th>
                        <th>–ò–≥—Ä–æ–∫</th>
                        <th>–ü–æ–±–µ–¥—ã</th>
                        <th>–ü–æ—Ä–∞–∂–µ–Ω–∏—è</th>
                        <th>–õ—É—á—à–µ–µ –≤—Ä–µ–º—è</th>
                        <th>–û—á–∫–∏</th>
                    </tr>
                </thead>
                <tbody id="standingsBody">
                    <!-- –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </tbody>
            </table>
        </div>

        <div id="tournamentContainer" class="tournament-grid">
            <!-- –¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Å–µ—Ç–∫–∞ –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>

        <div id="championContainer">
            <!-- –ü–æ–±–µ–¥–∏—Ç–µ–ª—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>

        <div class="controls" id="tournamentControls">
            <button class="btn btn-success" onclick="nextRound()" id="nextRoundBtn">–°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥</button>
            <button class="btn btn-danger" onclick="resetTournament()">–ù–æ–≤—ã–π —Ç—É—Ä–Ω–∏—Ä</button>
        </div>
    </div>

    <!-- JavaScript –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
    <script>
        // ... (–≤–µ—Å—å JavaScript –∫–æ–¥ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ Event1.html –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        // –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–µ—Å—å JavaScript –∫–æ–¥ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ Event1.html
        // –Ø –Ω–µ –º–µ–Ω—è–ª —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —Ç–æ–ª—å–∫–æ —Å—Ç–∏–ª–∏
        
        let players = [];
        let currentRound = 0;
        let tournamentData = [];
        let roundRobinMatches = [];
        let currentMatchIndex = 0;
        let playerStats = {};
        let selectedMode = '';
        let absentPlayers = new Set();
        let playersWithoutOpponents = new Set();
        let bossPlayer = '';

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', function() {
            loadTournamentState();
        });

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞ –≤ localStorage
        function saveTournamentState() {
            const state = {
                players,
                currentRound,
                tournamentData,
                roundRobinMatches,
                currentMatchIndex,
                playerStats,
                selectedMode,
                absentPlayers: Array.from(absentPlayers),
                playersWithoutOpponents: Array.from(playersWithoutOpponents),
                bossPlayer
            };
            localStorage.setItem('tournamentState', JSON.stringify(state));
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞ –∏–∑ localStorage
        function loadTournamentState() {
            const savedState = localStorage.getItem('tournamentState');
            if (savedState) {
                const state = JSON.parse(savedState);
                
                players = state.players || [];
                currentRound = state.currentRound || 0;
                tournamentData = state.tournamentData || [];
                roundRobinMatches = state.roundRobinMatches || [];
                currentMatchIndex = state.currentMatchIndex || 0;
                playerStats = state.playerStats || {};
                selectedMode = state.selectedMode || '';
                absentPlayers = new Set(state.absentPlayers || []);
                playersWithoutOpponents = new Set(state.playersWithoutOpponents || []);
                bossPlayer = state.bossPlayer || '';
                
                if (selectedMode) {
                    document.getElementById('modeSelector').style.display = 'none';
                    document.getElementById('configPanel').style.display = 'block';
                    
                    if (players.length > 0) {
                        document.getElementById('configPanel').style.display = 'none';
                        document.getElementById('tournamentContainer').style.display = 'flex';
                        document.getElementById('tournamentControls').style.display = 'block';
                        document.getElementById('standingsSection').style.display = 'block';
                        
                        renderTournament();
                        updateStandings();
                        
                        const currentRoundMatches = tournamentData[currentRound] || [];
                        const allMatchesCompleted = currentRoundMatches.every(match => match.winner);
                        document.getElementById('nextRoundBtn').disabled = !allMatchesCompleted;
                    }
                }
            }
        }

        // –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ —Ç—É—Ä–Ω–∏—Ä–∞
        function selectMode(mode) {
            selectedMode = mode;
            
            // –°–±—Ä–æ—Å –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–∏
            document.getElementById(mode + 'Mode').classList.add('active');
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
            const hint = document.getElementById('playersHint');
            const bossInputContainer = document.getElementById('bossInputContainer');
            
            if (mode === 'classic') {
                hint.textContent = '–ú–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞. –û–¥–∏–Ω–æ—á–Ω—ã–µ –º–∞—Ç—á–∏ –ø–æ –≤—ã–±–æ—Ä—É.';
                bossInputContainer.style.display = 'none';
            } else if (mode === 'bracket') {
                hint.textContent = '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç–µ–ø–µ–Ω—å—é –¥–≤–æ–π–∫–∏ (2, 4, 8, 16...). –û–ª–∏–º–ø–∏–π—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞.';
                bossInputContainer.style.display = 'none';
            } else if (mode === 'king') {
                hint.textContent = '–ú–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞. –ö–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ —Å—Ä–∞–∑–∏—Ç—Å—è —Å –∫–∞–∂–¥—ã–º!';
                bossInputContainer.style.display = 'none';
            } else if (mode === 'timer') {
                hint.textContent = '–ú–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞. –°–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞ –ª—É—á—à–µ–µ –≤—Ä–µ–º—è!';
                bossInputContainer.style.display = 'none';
            } else if (mode === 'boss') {
                hint.textContent = '–ú–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞. –í—Å–µ –∏–≥—Ä–æ–∫–∏ —Å—Ä–∞–∑—è—Ç—Å—è –ø—Ä–æ—Ç–∏–≤ –æ–¥–Ω–æ–≥–æ –±–æ—Å—Å–∞!';
                bossInputContainer.style.display = 'block';
            }
            
            // –ü–æ–∫–∞–∑ –ø–∞–Ω–µ–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            document.getElementById('modeSelector').style.display = 'none';
            document.getElementById('configPanel').style.display = 'block';
            
            saveTournamentState();
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –Ω–∞—á–∞–ª–æ —Ç—É—Ä–Ω–∏—Ä–∞
        function validateAndStart() {
            const input = document.getElementById('playersInput').value.trim();
            const statusMessage = document.getElementById('statusMessage');
            
            if (!input) {
                showStatus('–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º—ã –∏–≥—Ä–æ–∫–æ–≤', 'error');
                return;
            }

            players = input.split('\n')
                .map(name => name.trim())
                .filter(name => name.length > 0);

            if (players.length < 2) {
                showStatus('–ù—É–∂–Ω–æ –∫–∞–∫ –º–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞', 'error');
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ —Å–µ—Ç–∫–∏ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç–µ–ø–µ–Ω—å—é –¥–≤–æ–π–∫–∏)
            if (selectedMode === 'bracket') {
                if (!isPowerOfTwo(players.length)) {
                    showStatus('–î–ª—è —Ç—É—Ä–Ω–∏—Ä–∞ –ø–æ —Å–µ—Ç–∫–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç–µ–ø–µ–Ω—å—é –¥–≤–æ–π–∫–∏ (2, 4, 8, 16...)', 'error');
                    return;
                }
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ "–í—Å–µ –ø—Ä–æ—Ç–∏–≤ –ë–æ—Å—Å–∞"
            if (selectedMode === 'boss') {
                const bossInput = document.getElementById('bossInput').value.trim();
                
                if (!bossInput) {
                    showStatus('–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫ –ë–æ—Å—Å–∞', 'error');
                    return;
                }
                
                bossPlayer = bossInput;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ–±—ã –±–æ—Å—Å –Ω–µ —Å–æ–≤–ø–∞–¥–∞–ª —Å –æ–¥–Ω–∏–º –∏–∑ –∏–≥—Ä–æ–∫–æ–≤
                if (players.includes(bossPlayer)) {
                    showStatus('–ë–æ—Å—Å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–∏–º –∏–∑ –∏–≥—Ä–æ–∫–æ–≤', 'error');
                    return;
                }
                
                startBossTournament();
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–Ω
            const uniquePlayers = [...new Set(players)];
            if (uniquePlayers.length !== players.length) {
                showStatus('–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∏–º–µ–Ω–∞ –∏–≥—Ä–æ–∫–æ–≤', 'error');
                return;
            }

            showStatus(`–£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ ${players.length} –∏–≥—Ä–æ–∫–æ–≤!`, 'success');
            
            // –ó–∞–ø—É—Å–∫ —Ç—É—Ä–Ω–∏—Ä–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
            if (selectedMode === 'king') {
                startRoundRobin();
            } else if (selectedMode === 'bracket') {
                startBracketTournament();
            } else if (selectedMode === 'classic') {
                startClassicTournament();
            } else if (selectedMode === 'timer') {
                startTimerTournament();
            }
            
            saveTournamentState();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —á–∏—Å–ª–æ —Å—Ç–µ–ø–µ–Ω—å—é –¥–≤–æ–π–∫–∏
        function isPowerOfTwo(n) {
            return n > 0 && (n & (n - 1)) === 0;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
        function showStatus(message, type) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = 'status ' + type;
            statusElement.style.display = 'block';
        }

        // –ù–∞—á–∞–ª–æ —Ç—É—Ä–Ω–∏—Ä–∞ –ø–æ —Å–∏—Å—Ç–µ–º–µ "–∫–∞–∂–¥—ã–π —Å –∫–∞–∂–¥—ã–º"
        function startRoundRobin() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–æ–≤
            playerStats = {};
            players.forEach(player => {
                playerStats[player] = {
                    wins: 0,
                    losses: 0,
                    points: 0
                };
            });

            tournamentData = [];
            currentRound = 0;
            currentMatchIndex = 0;
            absentPlayers.clear();
            playersWithoutOpponents.clear();
            
            // –°–æ–∑–¥–∞–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–∞—Ä—ã –¥–ª—è —Å–∏—Å—Ç–µ–º—ã "–∫–∞–∂–¥—ã–π —Å –∫–∞–∂–¥—ã–º"
            roundRobinMatches = [];
            for (let i = 0; i < players.length; i++) {
                for (let j = i + 1; j < players.length; j++) {
                    roundRobinMatches.push({
                        player1: players[i],
                        player2: players[j],
                        winner: null,
                        played: false
                    });
                }
            }

            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –º–∞—Ç—á–∏ –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞
            roundRobinMatches = shuffleArray(roundRobinMatches);

            // –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–≤—ã–π —Ä–∞—É–Ω–¥
            createRoundFromMatches();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç—É—Ä–Ω–∏—Ä–∞
            document.getElementById('configPanel').style.display = 'none';
            document.getElementById('tournamentContainer').style.display = 'flex';
            document.getElementById('tournamentControls').style.display = 'block';
            document.getElementById('standingsSection').style.display = 'block';
            
            renderTournament();
            updateStandings();
            document.getElementById('nextRoundBtn').disabled = true;
            
            saveTournamentState();
        }

        // –ù–∞—á–∞–ª–æ —Ç—É—Ä–Ω–∏—Ä–∞ –ø–æ –æ–ª–∏–º–ø–∏–π—Å–∫–æ–π —Å–∏—Å—Ç–µ–º–µ
        function startBracketTournament() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–æ–≤
            playerStats = {};
            players.forEach(player => {
                playerStats[player] = {
                    wins: 0,
                    losses: 0,
                    points: 0
                };
            });

            tournamentData = [];
            currentRound = 0;
            absentPlayers.clear();
            playersWithoutOpponents.clear();
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
            const shuffledPlayers = shuffleArray([...players]);
            
            // –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–≤—ã–π —Ä–∞—É–Ω–¥
            const firstRound = [];
            for (let i = 0; i < shuffledPlayers.length; i += 2) {
                firstRound.push({
                    player1: shuffledPlayers[i],
                    player2: shuffledPlayers[i + 1],
                    winner: null,
                    played: false
                });
            }
            
            tournamentData.push(firstRound);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç—É—Ä–Ω–∏—Ä–∞
            document.getElementById('configPanel').style.display = 'none';
            document.getElementById('tournamentContainer').style.display = 'flex';
            document.getElementById('tournamentControls').style.display = 'block';
            document.getElementById('standingsSection').style.display = 'block';
            
            renderTournament();
            updateStandings();
            document.getElementById('nextRoundBtn').disabled = true;
            
            saveTournamentState();
        }

        // –ù–∞—á–∞–ª–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ —Ç—É—Ä–Ω–∏—Ä–∞ (–æ–¥–∏–Ω–æ—á–Ω—ã–µ –º–∞—Ç—á–∏)
        function startClassicTournament() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–æ–≤
            playerStats = {};
            players.forEach(player => {
                playerStats[player] = {
                    wins: 0,
                    losses: 0,
                    points: 0
                };
            });

            tournamentData = [];
            currentRound = 0;
            absentPlayers.clear();
            playersWithoutOpponents.clear();
            
            // –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–≤—ã–π —Ä–∞—É–Ω–¥ —Å–æ –≤—Å–µ–º–∏ –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ –ø–∞—Ä–∞–º–∏
            const firstRound = createRoundWithByePlayers([...players]);
            tournamentData.push(firstRound);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç—É—Ä–Ω–∏—Ä–∞
            document.getElementById('configPanel').style.display = 'none';
            document.getElementById('tournamentContainer').style.display = 'flex';
            document.getElementById('tournamentControls').style.display = 'block';
            document.getElementById('standingsSection').style.display = 'block';
            
            renderTournament();
            updateStandings();
            document.getElementById('nextRoundBtn').disabled = true;
            
            saveTournamentState();
        }

        // –ù–∞—á–∞–ª–æ —Ç—É—Ä–Ω–∏—Ä–∞ —Å —Ç–∞–π–º–µ—Ä–æ–º
        function startTimerTournament() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–æ–≤
            playerStats = {};
            players.forEach(player => {
                playerStats[player] = {
                    wins: 0,
                    losses: 0,
                    points: 0,
                    bestTime: null,
                    times: []
                };
            });

            tournamentData = [];
            currentRound = 0;
            absentPlayers.clear();
            playersWithoutOpponents.clear();
            
            // –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–≤—ã–π —Ä–∞—É–Ω–¥ —Å–æ –≤—Å–µ–º–∏ –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ –ø–∞—Ä–∞–º–∏
            const firstRound = createRoundWithByePlayers([...players]);
            tournamentData.push(firstRound);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç—É—Ä–Ω–∏—Ä–∞
            document.getElementById('configPanel').style.display = 'none';
            document.getElementById('tournamentContainer').style.display = 'flex';
            document.getElementById('tournamentControls').style.display = 'block';
            document.getElementById('standingsSection').style.display = 'block';
            
            renderTournament();
            updateStandings();
            document.getElementById('nextRoundBtn').disabled = true;
            
            saveTournamentState();
        }

        // –ù–∞—á–∞–ª–æ —Ç—É—Ä–Ω–∏—Ä–∞ "–í—Å–µ –ø—Ä–æ—Ç–∏–≤ –ë–æ—Å—Å–∞"
        function startBossTournament() {
            if (!bossPlayer) {
                showStatus('–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫ –ë–æ—Å—Å–∞', 'error');
                return;
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–æ–≤
            playerStats = {};
            players.forEach(player => {
                playerStats[player] = {
                    wins: 0,
                    losses: 0,
                    points: 0,
                    bestTime: null,
                    times: []
                };
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –±–æ—Å—Å–∞
            playerStats[bossPlayer] = {
                wins: 0,
                losses: 0,
                points: 0,
                bestTime: null,
                times: []
            };

            tournamentData = [];
            currentRound = 0;
            absentPlayers.clear();
            playersWithoutOpponents.clear();
            
            // –°–æ–∑–¥–∞–µ–º –º–∞—Ç—á–∏: –∫–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –ø—Ä–æ—Ç–∏–≤ –±–æ—Å—Å–∞
            const bossMatches = [];
            players.forEach(player => {
                bossMatches.push({
                    player1: player,
                    player2: bossPlayer,
                    winner: null,
                    played: false
                });
            });
            
            tournamentData.push(bossMatches);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç—É—Ä–Ω–∏—Ä–∞
            document.getElementById('configPanel').style.display = 'none';
            document.getElementById('tournamentContainer').style.display = 'flex';
            document.getElementById('tournamentControls').style.display = 'block';
            document.getElementById('standingsSection').style.display = 'block';
            
            renderTournament();
            updateStandings();
            document.getElementById('nextRoundBtn').disabled = true;
            
            saveTournamentState();
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—É–Ω–¥–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –º–∞—Ç—á–µ–π
        function createRoundFromMatches() {
            const roundMatches = [];
            const usedPlayers = new Set();
            
            // –°–æ–∑–¥–∞–µ–º –º–∞—Ç—á–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞—É–Ω–¥
            for (let i = currentMatchIndex; i < roundRobinMatches.length; i++) {
                const match = roundRobinMatches[i];
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É—á–∞—Å—Ç–≤—É—é—Ç –ª–∏ –∏–≥—Ä–æ–∫–∏ —É–∂–µ –≤ —ç—Ç–æ–º —Ä–∞—É–Ω–¥–µ
                if (!usedPlayers.has(match.player1) && !usedPlayers.has(match.player2)) {
                    roundMatches.push({
                        player1: match.player1,
                        player2: match.player2,
                        winner: null,
                        played: false
                    });
                    
                    usedPlayers.add(match.player1);
                    usedPlayers.add(match.player2);
                    
                    currentMatchIndex = i + 1;
                }
                
                // –ï—Å–ª–∏ –≤—Å–µ –∏–≥—Ä–æ–∫–∏ –∑–∞–Ω—è—Ç—ã –∏–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞, –≤—ã—Ö–æ–¥–∏–º
                if (usedPlayers.size === players.length || i === roundRobinMatches.length - 1) {
                    break;
                }
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞—É–Ω–¥ –≤ —Ç—É—Ä–Ω–∏—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            if (roundMatches.length > 0) {
                tournamentData.push(roundMatches);
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—É–Ω–¥–∞ —Å —É—á–µ—Ç–æ–º –∏–≥—Ä–æ–∫–æ–≤ –±–µ–∑ –æ–ø–ø–æ–Ω–µ–Ω—Ç–æ–≤
        function createRoundWithByePlayers(availablePlayers) {
            const matches = [];
            const shuffledPlayers = shuffleArray(availablePlayers);
            
            // –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—ã –¥–ª—è –º–∞—Ç—á–µ–π
            for (let i = 0; i < shuffledPlayers.length; i += 2) {
                if (i + 1 < shuffledPlayers.length) {
                    matches.push({
                        player1: shuffledPlayers[i],
                        player2: shuffledPlayers[i + 1],
                        winner: null,
                        played: false
                    });
                } else {
                    // –ï—Å–ª–∏ –æ—Å—Ç–∞–ª—Å—è –æ–¥–∏–Ω –∏–≥—Ä–æ–∫ –±–µ–∑ –ø–∞—Ä—ã, –æ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                    playersWithoutOpponents.add(shuffledPlayers[i]);
                }
            }
            
            return matches;
        }

        // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç—É—Ä–Ω–∏—Ä–∞
        function renderTournament() {
            const container = document.getElementById('tournamentContainer');
            container.innerHTML = '';
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
            document.getElementById('championContainer').innerHTML = '';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω –ª–∏ —Ç—É—Ä–Ω–∏—Ä
            if (selectedMode === 'bracket' && tournamentData.length > 0) {
                const lastRound = tournamentData[tournamentData.length - 1];
                if (lastRound.length === 1 && lastRound[0].winner) {
                    showChampion(lastRound[0].winner);
                    return;
                }
            }
            
            // –î–ª—è —Ä–µ–∂–∏–º–∞ "–∫–∞–∂–¥—ã–π —Å –∫–∞–∂–¥—ã–º" –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∏–π —Ä–∞—É–Ω–¥
            if (selectedMode === 'king') {
                if (currentRound < tournamentData.length) {
                    renderRound(tournamentData[currentRound], `–†–∞—É–Ω–¥ ${currentRound + 1}`);
                } else {
                    // –í—Å–µ –º–∞—Ç—á–∏ —Å—ã–≥—Ä–∞–Ω—ã, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
                    determineRoundRobinWinner();
                }
            } 
            // –î–ª—è —Ä–µ–∂–∏–º–∞ "–í—Å–µ –ø—Ä–æ—Ç–∏–≤ –ë–æ—Å—Å–∞" –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –º–∞—Ç—á–∏
            else if (selectedMode === 'boss') {
                if (currentRound < tournamentData.length) {
                    renderBossRound(tournamentData[currentRound], `–í—Å–µ –ø—Ä–æ—Ç–∏–≤ –ë–æ—Å—Å–∞`);
                }
            }
            // –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —Ä–∞—É–Ω–¥—ã
            else {
                for (let i = 0; i < tournamentData.length; i++) {
                    renderRound(tournamentData[i], `–†–∞—É–Ω–¥ ${i + 1}`, i);
                }
            }
            
            saveTournamentState();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ä–∞—É–Ω–¥–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ "–í—Å–µ –ø—Ä–æ—Ç–∏–≤ –ë–æ—Å—Å–∞"
        function renderBossRound(matches, roundTitle) {
            const container = document.getElementById('tournamentContainer');
            
            const roundDiv = document.createElement('div');
            roundDiv.className = 'round';
            
            const roundTitleDiv = document.createElement('div');
            roundTitleDiv.className = 'round-title';
            roundTitleDiv.textContent = roundTitle;
            roundDiv.appendChild(roundTitleDiv);
            
            matches.forEach((match, index) => {
                const matchDiv = document.createElement('div');
                matchDiv.className = 'match';
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫—Ç–æ –∏–∑ –∏–≥—Ä–æ–∫–æ–≤ —è–≤–ª—è–µ—Ç—Å—è –±–æ—Å—Å–æ–º
                const isPlayer1Boss = match.player1 === bossPlayer;
                const isPlayer2Boss = match.player2 === bossPlayer;
                
                const player1Div = document.createElement('div');
                player1Div.className = `player ${isPlayer1Boss ? 'boss-player' : ''} ${match.winner === match.player1 ? 'winner' : ''} ${match.winner && match.winner !== match.player1 ? 'loser' : ''} ${absentPlayers.has(match.player1) ? 'absent' : ''}`;
                player1Div.innerHTML = `
                    ${match.player1}
                    ${match.played && match.player1Time ? `<span class="player-time">${match.player1Time}</span>` : ''}
                `;
                player1Div.onclick = () => selectWinner(match, match.player1, currentRound, index);
                
                const player2Div = document.createElement('div');
                player2Div.className = `player ${isPlayer2Boss ? 'boss-player' : ''} ${match.winner === match.player2 ? 'winner' : ''} ${match.winner && match.winner !== match.player2 ? 'loser' : ''} ${absentPlayers.has(match.player2) ? 'absent' : ''}`;
                player2Div.innerHTML = `
                    ${match.player2}
                    ${match.played && match.player2Time ? `<span class="player-time">${match.player2Time}</span>` : ''}
                `;
                player2Div.onclick = () => selectWinner(match, match.player2, currentRound, index);
                
                const vsDiv = document.createElement('div');
                vsDiv.className = 'vs';
                vsDiv.textContent = 'VS';
                
                matchDiv.appendChild(player1Div);
                matchDiv.appendChild(vsDiv);
                matchDiv.appendChild(player2Div);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'player-actions';
                
                // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–∞ 1
                const absent1Btn = document.createElement('button');
                absent1Btn.className = `action-btn ${absentPlayers.has(match.player1) ? 'present' : 'absent'}`;
                absent1Btn.textContent = absentPlayers.has(match.player1) ? `${match.player1} –≤–µ—Ä–Ω—É–ª—Å—è` : `${match.player1} –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç`;
                absent1Btn.onclick = (e) => {
                    e.stopPropagation();
                    toggleAbsentPlayer(match.player1);
                };
                
                // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–∞ 2
                const absent2Btn = document.createElement('button');
                absent2Btn.className = `action-btn ${absentPlayers.has(match.player2) ? 'present' : 'absent'}`;
                absent2Btn.textContent = absentPlayers.has(match.player2) ? `${match.player2} –≤–µ—Ä–Ω—É–ª—Å—è` : `${match.player2} –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç`;
                absent2Btn.onclick = (e) => {
                    e.stopPropagation();
                    toggleAbsentPlayer(match.player2);
                };
                
                // –ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–∞—Ç—á–∞
                const undoBtn = document.createElement('button');
                undoBtn.className = 'action-btn undo';
                undoBtn.textContent = '–û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç';
                undoBtn.onclick = (e) => {
                    e.stopPropagation();
                    undoMatch(match, currentRound, index);
                };
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –º–∞—Ç—á –µ—â–µ –Ω–µ —Å—ã–≥—Ä–∞–Ω
                if (!match.played) {
                    actionsDiv.appendChild(absent1Btn);
                    actionsDiv.appendChild(absent2Btn);
                } else {
                    actionsDiv.appendChild(undoBtn);
                }
                
                // –î–ª—è —Ä–µ–∂–∏–º–∞ —Å —Ç–∞–π–º–µ—Ä–æ–º –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –≤—Ä–µ–º–µ–Ω–∏
                if (selectedMode === 'timer' || selectedMode === 'boss') {
                    const timerDiv = document.createElement('div');
                    timerDiv.className = 'timer-input-container';
                    
                    const timerInput = document.createElement('input');
                    timerInput.type = 'text';
                    timerInput.className = 'timer-input';
                    timerInput.placeholder = '–º–º:—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 02:30)';
                    timerInput.pattern = '[0-9]{2}:[0-9]{2}';
                    
                    const timerBtn = document.createElement('button');
                    timerBtn.className = 'action-btn timer';
                    timerBtn.textContent = '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è';
                    timerBtn.onclick = (e) => {
                        e.stopPropagation();
                        const time = timerInput.value.trim();
                        if (isValidTimeFormat(time)) {
                            setMatchTime(match, time, currentRound, index);
                            timerInput.value = '';
                        } else {
                            alert('–í–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –º–º:—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 02:30)');
                        }
                    };
                    
                    timerDiv.appendChild(timerInput);
                    timerDiv.appendChild(timerBtn);
                    matchDiv.appendChild(timerDiv);
                }
                
                matchDiv.appendChild(actionsDiv);
                roundDiv.appendChild(matchDiv);
            });
            
            container.appendChild(roundDiv);
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ–±—ã—á–Ω–æ–≥–æ —Ä–∞—É–Ω–¥–∞
        function renderRound(matches, roundTitle, roundIndex) {
            const container = document.getElementById('tournamentContainer');
            
            const roundDiv = document.createElement('div');
            roundDiv.className = 'round';
            
            const roundTitleDiv = document.createElement('div');
            roundTitleDiv.className = 'round-title';
            roundTitleDiv.textContent = roundTitle;
            roundDiv.appendChild(roundTitleDiv);
            
            matches.forEach((match, index) => {
                const matchDiv = document.createElement('div');
                matchDiv.className = 'match';
                
                const player1Div = document.createElement('div');
                player1Div.className = `player ${match.winner === match.player1 ? 'winner' : ''} ${match.winner && match.winner !== match.player1 ? 'loser' : ''} ${absentPlayers.has(match.player1) ? 'absent' : ''}`;
                player1Div.innerHTML = `
                    ${match.player1}
                    ${match.played && match.player1Time ? `<span class="player-time">${match.player1Time}</span>` : ''}
                `;
                player1Div.onclick = () => selectWinner(match, match.player1, roundIndex, index);
                
                const player2Div = document.createElement('div');
                player2Div.className = `player ${match.winner === match.player2 ? 'winner' : ''} ${match.winner && match.winner !== match.player2 ? 'loser' : ''} ${absentPlayers.has(match.player2) ? 'absent' : ''}`;
                player2Div.innerHTML = `
                    ${match.player2}
                    ${match.played && match.player2Time ? `<span class="player-time">${match.player2Time}</span>` : ''}
                `;
                player2Div.onclick = () => selectWinner(match, match.player2, roundIndex, index);
                
                const vsDiv = document.createElement('div');
                vsDiv.className = 'vs';
                vsDiv.textContent = 'VS';
                
                matchDiv.appendChild(player1Div);
                matchDiv.appendChild(vsDiv);
                matchDiv.appendChild(player2Div);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'player-actions';
                
                // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–∞ 1
                const absent1Btn = document.createElement('button');
                absent1Btn.className = `action-btn ${absentPlayers.has(match.player1) ? 'present' : 'absent'}`;
                absent1Btn.textContent = absentPlayers.has(match.player1) ? `${match.player1} –≤–µ—Ä–Ω—É–ª—Å—è` : `${match.player1} –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç`;
                absent1Btn.onclick = (e) => {
                    e.stopPropagation();
                    toggleAbsentPlayer(match.player1);
                };
                
                // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–∞ 2
                const absent2Btn = document.createElement('button');
                absent2Btn.className = `action-btn ${absentPlayers.has(match.player2) ? 'present' : 'absent'}`;
                absent2Btn.textContent = absentPlayers.has(match.player2) ? `${match.player2} –≤–µ—Ä–Ω—É–ª—Å—è` : `${match.player2} –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç`;
                absent2Btn.onclick = (e) => {
                    e.stopPropagation();
                    toggleAbsentPlayer(match.player2);
                };
                
                // –ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–∞—Ç—á–∞
                const undoBtn = document.createElement('button');
                undoBtn.className = 'action-btn undo';
                undoBtn.textContent = '–û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç';
                undoBtn.onclick = (e) => {
                    e.stopPropagation();
                    undoMatch(match, roundIndex, index);
                };
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –º–∞—Ç—á –µ—â–µ –Ω–µ —Å—ã–≥—Ä–∞–Ω
                if (!match.played) {
                    actionsDiv.appendChild(absent1Btn);
                    actionsDiv.appendChild(absent2Btn);
                } else {
                    actionsDiv.appendChild(undoBtn);
                }
                
                // –î–ª—è —Ä–µ–∂–∏–º–∞ —Å —Ç–∞–π–º–µ—Ä–æ–º –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –≤—Ä–µ–º–µ–Ω–∏
                if (selectedMode === 'timer' || selectedMode === 'boss') {
                    const timerDiv = document.createElement('div');
                    timerDiv.className = 'timer-input-container';
                    
                    const timerInput = document.createElement('input');
                    timerInput.type = 'text';
                    timerInput.className = 'timer-input';
                    timerInput.placeholder = '–º–º:—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 02:30)';
                    timerInput.pattern = '[0-9]{2}:[0-9]{2}';
                    
                    const timerBtn = document.createElement('button');
                    timerBtn.className = 'action-btn timer';
                    timerBtn.textContent = '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è';
                    timerBtn.onclick = (e) => {
                        e.stopPropagation();
                        const time = timerInput.value.trim();
                        if (isValidTimeFormat(time)) {
                            setMatchTime(match, time, roundIndex, index);
                            timerInput.value = '';
                        } else {
                            alert('–í–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –º–º:—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 02:30)');
                        }
                    };
                    
                    timerDiv.appendChild(timerInput);
                    timerDiv.appendChild(timerBtn);
                    matchDiv.appendChild(timerDiv);
                }
                
                matchDiv.appendChild(actionsDiv);
                roundDiv.appendChild(matchDiv);
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤ –±–µ–∑ –æ–ø–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ —ç—Ç–æ–º —Ä–∞—É–Ω–¥–µ
            if (playersWithoutOpponents.size > 0 && roundIndex === currentRound) {
                const byeDiv = document.createElement('div');
                byeDiv.className = 'match';
                byeDiv.innerHTML = '<div class="round-title">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç:</div>';
                
                playersWithoutOpponents.forEach(player => {
                    const playerDiv = document.createElement('div');
                    playerDiv.className = 'player bye';
                    playerDiv.textContent = player;
                    byeDiv.appendChild(playerDiv);
                });
                
                roundDiv.appendChild(byeDiv);
            }
            
            container.appendChild(roundDiv);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏
        function isValidTimeFormat(time) {
            const timeRegex = /^[0-9]{2}:[0-9]{2}$/;
            if (!timeRegex.test(time)) return false;
            
            const [minutes, seconds] = time.split(':').map(Number);
            return minutes >= 0 && minutes < 60 && seconds >= 0 && seconds < 60;
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –º–∞—Ç—á–∞
        function setMatchTime(match, time, roundIndex, matchIndex) {
            if (!match.played) {
                alert('–°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –º–∞—Ç—á–∞!');
                return;
            }
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–æ–µ –≤—Ä–µ–º—è –¥–ª—è –∫–∞–∫–æ–≥–æ –∏–≥—Ä–æ–∫–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å
            if (match.winner === match.player1) {
                match.player1Time = time;
                match.player2Time = null;
            } else if (match.winner === match.player2) {
                match.player2Time = time;
                match.player1Time = null;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–æ–≤
            if (selectedMode === 'timer' || selectedMode === 'boss') {
                updatePlayerTimeStats(match.winner, time);
            }
            
            renderTournament();
            updateStandings();
            saveTournamentState();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –∏–≥—Ä–æ–∫–∞
        function updatePlayerTimeStats(player, time) {
            if (!playerStats[player]) return;
            
            const timeInSeconds = convertTimeToSeconds(time);
            playerStats[player].times.push(timeInSeconds);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ª—É—á—à–µ–µ –≤—Ä–µ–º—è
            if (playerStats[player].bestTime === null || timeInSeconds < playerStats[player].bestTime) {
                playerStats[player].bestTime = timeInSeconds;
            }
        }

        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å–µ–∫—É–Ω–¥—ã
        function convertTimeToSeconds(time) {
            const [minutes, seconds] = time.split(':').map(Number);
            return minutes * 60 + seconds;
        }

        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å–µ–∫—É–Ω–¥ –≤ —Ñ–æ—Ä–º–∞—Ç –º–º:—Å—Å
        function convertSecondsToTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // –í—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
        function selectWinner(match, winner, roundIndex, matchIndex) {
            if (match.played) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ–±–µ–¥–∏—Ç–µ–ª—å
            if (absentPlayers.has(winner)) {
                alert('–≠—Ç–æ—Ç –∏–≥—Ä–æ–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç! –°–Ω–∞—á–∞–ª–∞ –æ—Ç–º–µ—Ç—å—Ç–µ –µ–≥–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º.');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫
            const opponent = winner === match.player1 ? match.player2 : match.player1;
            if (absentPlayers.has(opponent)) {
                // –ï—Å–ª–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Å—É–∂–¥–∞–µ–º –ø–æ–±–µ–¥—É
                match.winner = winner;
                match.played = true;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                playerStats[winner].wins++;
                playerStats[opponent].losses++;
                playerStats[winner].points += 3;
                
                renderTournament();
                updateStandings();
                checkRoundCompletion();
                saveTournamentState();
                return;
            }
            
            // –û–±—ã—á–Ω—ã–π –≤—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
            match.winner = winner;
            match.played = true;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            playerStats[winner].wins++;
            playerStats[opponent].losses++;
            playerStats[winner].points += 3;
            
            renderTournament();
            updateStandings();
            checkRoundCompletion();
            saveTournamentState();
        }

        // –û—Ç–º–µ–Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–∞—Ç—á–∞
        function undoMatch(match, roundIndex, matchIndex) {
            if (!match.played) return;
            
            const winner = match.winner;
            const loser = winner === match.player1 ? match.player2 : match.player1;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –º–∞—Ç—á
            match.winner = null;
            match.played = false;
            match.player1Time = null;
            match.player2Time = null;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            playerStats[winner].wins--;
            playerStats[loser].losses--;
            playerStats[winner].points -= 3;
            
            // –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º—è –∏–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –µ—Å–ª–∏ –æ–Ω–æ –±—ã–ª–æ
            if (selectedMode === 'timer' || selectedMode === 'boss') {
                if (match.player1Time) {
                    const timeInSeconds = convertTimeToSeconds(match.player1Time);
                    const timeIndex = playerStats[winner].times.indexOf(timeInSeconds);
                    if (timeIndex > -1) {
                        playerStats[winner].times.splice(timeIndex, 1);
                    }
                    
                    // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ª—É—á—à–µ–µ –≤—Ä–µ–º—è
                    if (playerStats[winner].times.length === 0) {
                        playerStats[winner].bestTime = null;
                    } else {
                        playerStats[winner].bestTime = Math.min(...playerStats[winner].times);
                    }
                }
                
                if (match.player2Time) {
                    const timeInSeconds = convertTimeToSeconds(match.player2Time);
                    const timeIndex = playerStats[winner].times.indexOf(timeInSeconds);
                    if (timeIndex > -1) {
                        playerStats[winner].times.splice(timeIndex, 1);
                    }
                    
                    // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ª—É—á—à–µ–µ –≤—Ä–µ–º—è
                    if (playerStats[winner].times.length === 0) {
                        playerStats[winner].bestTime = null;
                    } else {
                        playerStats[winner].bestTime = Math.min(...playerStats[winner].times);
                    }
                }
            }
            
            renderTournament();
            updateStandings();
            document.getElementById('nextRoundBtn').disabled = true;
            saveTournamentState();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–∞
        function toggleAbsentPlayer(player) {
            if (absentPlayers.has(player)) {
                absentPlayers.delete(player);
            } else {
                absentPlayers.add(player);
            }
            
            renderTournament();
            saveTournamentState();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞—É–Ω–¥–∞
        function checkRoundCompletion() {
            const currentRoundMatches = tournamentData[currentRound];
            const allMatchesCompleted = currentRoundMatches.every(match => match.played);
            
            document.getElementById('nextRoundBtn').disabled = !allMatchesCompleted;
            saveTournamentState();
        }

        // –°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥
        function nextRound() {
            const currentRoundMatches = tournamentData[currentRound];
            const allMatchesCompleted = currentRoundMatches.every(match => match.played);
            
            if (!allMatchesCompleted) {
                alert('–ù–µ –≤—Å–µ –º–∞—Ç—á–∏ —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞—É–Ω–¥–∞ –∑–∞–≤–µ—Ä—à–µ–Ω—ã!');
                return;
            }
            
            // –î–ª—è —Ä–µ–∂–∏–º–∞ "–∫–∞–∂–¥—ã–π —Å –∫–∞–∂–¥—ã–º" —Å–æ–∑–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥ –∏–∑ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –º–∞—Ç—á–µ–π
            if (selectedMode === 'king') {
                if (currentMatchIndex < roundRobinMatches.length) {
                    currentRound++;
                    createRoundFromMatches();
                } else {
                    // –í—Å–µ –º–∞—Ç—á–∏ —Å—ã–≥—Ä–∞–Ω—ã
                    determineRoundRobinWinner();
                    return;
                }
            }
            // –î–ª—è —Ä–µ–∂–∏–º–∞ —Å–µ—Ç–∫–∏ —Å–æ–∑–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥
            else if (selectedMode === 'bracket') {
                const winners = [];
                
                // –°–æ–±–∏—Ä–∞–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞—É–Ω–¥–∞
                currentRoundMatches.forEach(match => {
                    if (match.winner) {
                        winners.push(match.winner);
                    }
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–æ–≤ –±–µ–∑ –æ–ø–ø–æ–Ω–µ–Ω—Ç–æ–≤
                playersWithoutOpponents.forEach(player => {
                    winners.push(player);
                });
                playersWithoutOpponents.clear();
                
                // –ï—Å–ª–∏ –æ—Å—Ç–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–æ–±–µ–¥–∏—Ç–µ–ª—å - —Ç—É—Ä–Ω–∏—Ä –∑–∞–≤–µ—Ä—à–µ–Ω
                if (winners.length === 1) {
                    showChampion(winners[0]);
                    return;
                }
                
                // –°–æ–∑–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥
                currentRound++;
                const nextRoundMatches = createRoundWithByePlayers(winners);
                tournamentData.push(nextRoundMatches);
            }
            // –î–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞ –∏ —Ä–µ–∂–∏–º–∞ —Å —Ç–∞–π–º–µ—Ä–æ–º –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Ä–∞—É–Ω–¥
            else if (selectedMode === 'classic' || selectedMode === 'timer' || selectedMode === 'boss') {
                // –í —ç—Ç–∏—Ö —Ä–µ–∂–∏–º–∞—Ö –æ–±—ã—á–Ω–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞—É–Ω–¥, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞—É–Ω–¥–æ–≤
                alert('–¢—É—Ä–Ω–∏—Ä –∑–∞–≤–µ—Ä—à–µ–Ω! –ú–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Ç—É—Ä–Ω–∏—Ä.');
                return;
            }
            
            renderTournament();
            updateStandings();
            document.getElementById('nextRoundBtn').disabled = true;
            saveTournamentState();
        }

        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –≤ —Ä–µ–∂–∏–º–µ "–∫–∞–∂–¥—ã–π —Å –∫–∞–∂–¥—ã–º"
        function determineRoundRobinWinner() {
            let maxPoints = -1;
            let winners = [];
            
            // –ù–∞—Ö–æ–¥–∏–º –∏–≥—Ä–æ–∫–æ–≤ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—á–∫–æ–≤
            for (const player in playerStats) {
                if (playerStats[player].points > maxPoints) {
                    maxPoints = playerStats[player].points;
                    winners = [player];
                } else if (playerStats[player].points === maxPoints) {
                    winners.push(player);
                }
            }
            
            // –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π, –≤—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ
            const champion = winners[Math.floor(Math.random() * winners.length)];
            showChampion(champion);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
        function showChampion(winner) {
            const container = document.getElementById('championContainer');
            container.innerHTML = '';
            
            const championDiv = document.createElement('div');
            championDiv.className = 'champion';
            
            championDiv.innerHTML = `
                <h2>üèÜ –ü–û–ë–ï–î–ò–¢–ï–õ–¨ –¢–£–†–ù–ò–†–ê üèÜ</h2>
                <div class="winner-name">${winner}</div>
                <div class="champion-stats">–ü–æ–±–µ–¥: ${playerStats[winner].wins}</div>
                <div class="champion-stats">–ü–æ—Ä–∞–∂–µ–Ω–∏–π: ${playerStats[winner].losses}</div>
                <div class="champion-stats">–û—á–∫–æ–≤: ${playerStats[winner].points}</div>
                ${playerStats[winner].bestTime ? `<div class="champion-stats">–õ—É—á—à–µ–µ –≤—Ä–µ–º—è: ${convertSecondsToTime(playerStats[winner].bestTime)}</div>` : ''}
            `;
            
            container.appendChild(championDiv);
            document.getElementById('nextRoundBtn').disabled = true;
            saveTournamentState();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤
        function updateStandings() {
            const standingsBody = document.getElementById('standingsBody');
            standingsBody.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
            const sortedPlayers = Object.keys(playerStats).sort((a, b) => {
                // –°–Ω–∞—á–∞–ª–∞ –ø–æ –æ—á–∫–∞–º
                if (playerStats[b].points !== playerStats[a].points) {
                    return playerStats[b].points - playerStats[a].points;
                }
                
                // –ó–∞—Ç–µ–º –ø–æ –ø–æ–±–µ–¥–∞–º
                if (playerStats[b].wins !== playerStats[a].wins) {
                    return playerStats[b].wins - playerStats[a].wins;
                }
                
                // –î–ª—è —Ä–µ–∂–∏–º–∞ —Å —Ç–∞–π–º–µ—Ä–æ–º - –ø–æ –ª—É—á—à–µ–º—É –≤—Ä–µ–º–µ–Ω–∏
                if (selectedMode === 'timer' || selectedMode === 'boss') {
                    if (playerStats[a].bestTime !== null && playerStats[b].bestTime !== null) {
                        return playerStats[a].bestTime - playerStats[b].bestTime;
                    } else if (playerStats[a].bestTime !== null) {
                        return -1;
                    } else if (playerStats[b].bestTime !== null) {
                        return 1;
                    }
                }
                
                // –ù–∞–∫–æ–Ω–µ—Ü, –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
                return a.localeCompare(b);
            });
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É
            sortedPlayers.forEach((player, index) => {
                const row = document.createElement('tr');
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏
                let positionClass = '';
                if (index === 0) positionClass = 'position-1';
                else if (index === 1) positionClass = 'position-2';
                else if (index === 2) positionClass = 'position-3';
                
                row.className = positionClass;
                
                const stats = playerStats[player];
                const bestTimeDisplay = stats.bestTime ? convertSecondsToTime(stats.bestTime) : '-';
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${player}</td>
                    <td>${stats.wins}</td>
                    <td>${stats.losses}</td>
                    <td>${bestTimeDisplay}</td>
                    <td>${stats.points}</td>
                `;
                
                standingsBody.appendChild(row);
            });
            
            saveTournamentState();
        }

        // –°–±—Ä–æ—Å —Ç—É—Ä–Ω–∏—Ä–∞
        function resetTournament() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Ç—É—Ä–Ω–∏—Ä? –í—Å–µ —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) {
                // –û—á–∏—â–∞–µ–º localStorage
                localStorage.removeItem('tournamentState');
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
                players = [];
                currentRound = 0;
                tournamentData = [];
                roundRobinMatches = [];
                currentMatchIndex = 0;
                playerStats = {};
                selectedMode = '';
                absentPlayers.clear();
                playersWithoutOpponents.clear();
                bossPlayer = '';
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                document.getElementById('playersInput').value = '';
                document.getElementById('bossInput').value = '';
                document.getElementById('tournamentContainer').innerHTML = '';
                document.getElementById('championContainer').innerHTML = '';
                document.getElementById('standingsBody').innerHTML = '';
                document.getElementById('standingsSection').style.display = 'none';
                document.getElementById('tournamentControls').style.display = 'none';
                document.getElementById('configPanel').style.display = 'none';
                document.getElementById('modeSelector').style.display = 'block';
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —Ä–µ–∂–∏–º–æ–≤
                document.querySelectorAll('.mode-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
            }
        }
    </script>
</body>
</html>